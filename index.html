<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Vacunación - El Salvador</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="form-container">
        <h1>Sistema de Vacunación</h1>
        <h2>El Salvador</h2>

        <!-- Botones de selección por grupo de edad/género -->
        <div class="button-group">
            <button id="btn-ninos" class="btn" onclick="showForm('ninos')">Niños</button>
            <button id="btn-adultos" class="btn" onclick="showForm('adultos')">Adultos</button>
            <button id="btn-embarazadas" class="btn" onclick="showForm('embarazadas')">Mujeres Embarazadas</button>
            <button id="btn-mayores" class="btn" onclick="showForm('mayores')">Mayores de Edad</button>
        </div>

        <!-- Formulario dinámico que cambia según el grupo seleccionado -->
        <div id="vacunacion-form">
            <!-- Aquí se mostrarán los formularios específicos de cada grupo -->
        </div>
    </div>

    <script>
        // Datos de vacunas por grupo
        const vacunasPorGrupo = {
            ninos: [
                { nombre: "BCG (Tuberculosis)", fecha: "al nacer" },
                { nombre: "Hepatitis B", fecha: "al nacer" },
                { nombre: "Pentavalente", fecha: "2, 4 y 6 meses" },
                { nombre: "Polio", fecha: "2, 4 y 6 meses" }
            ],
            adultos: [
                { nombre: "Influenza", fecha: "anual" },
                { nombre: "Tétanos", fecha: "cada 10 años" },
                { nombre: "Hepatitis B", fecha: "3 dosis" }
            ],
            embarazadas: [
                { nombre: "Influenza", fecha: "a partir de las 13 semanas" },
                { nombre: "Tétanos", fecha: "en el tercer trimestre" }
            ],
            mayores: [
                { nombre: "Neumococo", fecha: "una dosis" },
                { nombre: "Influenza", fecha: "anual" }
            ]
        };

        // Función para mostrar las vacunas correspondientes según el grupo seleccionado
        function showForm(grupo) {
            const container = document.getElementById('vacunacion-form');
            container.innerHTML = ''; // Limpiar el contenido actual

            // Crear el formulario de vacunas para el grupo seleccionado
            const vacunas = vacunasPorGrupo[grupo];
            let formHTML = `<h3>Vacunas para ${grupo.charAt(0).toUpperCase() + grupo.slice(1)}</h3>`;
            formHTML += `<form id="vacunaForm" onsubmit="guardarDatos(event)">`; // Agregar formulario

            vacunas.forEach(vacuna => {
                formHTML += `
                    <div class="form-group">
                        <label>${vacuna.nombre} (Administrar: ${vacuna.fecha})</label>
                        <input type="date" name="${vacuna.nombre}" required>
                    </div>`;
            });

            formHTML += `
                <div class="button-container">
                    <button type="submit">Guardar Datos</button>
                </div>
                </form>`; // Cerrar formulario
            
            container.innerHTML = formHTML;
        }

        // Función para guardar los datos
        async function guardarDatos(event) {
            event.preventDefault(); // Evitar el comportamiento por defecto del formulario

            const formData = new FormData(event.target); // Obtener datos del formulario
            const data = Object.fromEntries(formData.entries()); // Convertir FormData a un objeto

            // Enviar datos al servidor
            const response = await fetch('/guardar-vacunas', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
            });

            if (response.ok) {
                alert('Datos guardados correctamente.');
            } else {
                alert('Error al guardar los datos.');
            }
        }
    </script>
</body>
</html>
